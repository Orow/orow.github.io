<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="1. 後端 server 第一次的接觸前端應用也需要了解後端 server 的運作，在交握工作能更快速的彼此了解，進而加速工作效益。從 github 上找了一個例子利用 node.js 的框架 express 來分析如何運作。 1.1 簡單的 Express 伺服器Express 伺服器說明的參考資料 Express 的 server 與 router 概念目前沒有很熟悉，知道 router 是後">
<meta name="keywords" content="javascript,ajax,jQuery,node.js,express">
<meta property="og:type" content="article">
<meta property="og:title" content="[Node.js] - Express-Postman模擬">
<meta property="og:url" content="https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/index.html">
<meta property="og:site_name" content="Orow&#39;s Blog">
<meta property="og:description" content="1. 後端 server 第一次的接觸前端應用也需要了解後端 server 的運作，在交握工作能更快速的彼此了解，進而加速工作效益。從 github 上找了一個例子利用 node.js 的框架 express 來分析如何運作。 1.1 簡單的 Express 伺服器Express 伺服器說明的參考資料 Express 的 server 與 router 概念目前沒有很熟悉，知道 router 是後">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://i.imgur.com/GWwc662.png">
<meta property="og:image" content="https://i.imgur.com/1jKNRvq.png">
<meta property="og:image" content="https://i.imgur.com/QTyWL5B.png">
<meta property="og:image" content="https://i.imgur.com/TiAvdbK.png">
<meta property="og:image" content="https://i.imgur.com/TaqatCC.png">
<meta property="og:image" content="https://i.imgur.com/AiAwaKH.png">
<meta property="og:image" content="https://i.imgur.com/1joHKh8.png">
<meta property="og:image" content="https://i.imgur.com/ZmsXypg.png">
<meta property="og:image" content="https://i.imgur.com/Jld8kZn.png">
<meta property="og:image" content="https://i.imgur.com/pUfXmow.png">
<meta property="og:updated_time" content="2019-08-29T06:12:32.472Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="[Node.js] - Express-Postman模擬">
<meta name="twitter:description" content="1. 後端 server 第一次的接觸前端應用也需要了解後端 server 的運作，在交握工作能更快速的彼此了解，進而加速工作效益。從 github 上找了一個例子利用 node.js 的框架 express 來分析如何運作。 1.1 簡單的 Express 伺服器Express 伺服器說明的參考資料 Express 的 server 與 router 概念目前沒有很熟悉，知道 router 是後">
<meta name="twitter:image" content="https://i.imgur.com/GWwc662.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>[Node.js] - Express-Postman模擬</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/categories/project">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/04/10/nodejs-ajax_practice/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/04/06/DaanWeather/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/&text=[Node.js] - Express-Postman模擬"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/&title=[Node.js] - Express-Postman模擬"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/&is_video=false&description=[Node.js] - Express-Postman模擬"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=[Node.js] - Express-Postman模擬&body=Check out this article: https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/&title=[Node.js] - Express-Postman模擬"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/&title=[Node.js] - Express-Postman模擬"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/&title=[Node.js] - Express-Postman模擬"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/&title=[Node.js] - Express-Postman模擬"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/&name=[Node.js] - Express-Postman模擬&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-後端-server-第一次的接觸"><span class="toc-number">1.</span> <span class="toc-text">1. 後端 server 第一次的接觸</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-簡單的-Express-伺服器"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 簡單的 Express 伺服器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-request-與-response-參數獲取"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 request 與 response 參數獲取</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Github-參考資料"><span class="toc-number">2.</span> <span class="toc-text">2. Github 參考資料</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-觀察分析-API"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 觀察分析 API</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-Chrome-Network"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1 Chrome Network</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-Postman"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2 Postman</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        [Node.js] - Express-Postman模擬
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Orow's Blog</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-04-08T13:50:00.000Z" itemprop="datePublished">2019-04-08</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/ajax/">ajax</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/ajax/">ajax</a>, <a class="tag-link" href="/tags/express/">express</a>, <a class="tag-link" href="/tags/jQuery/">jQuery</a>, <a class="tag-link" href="/tags/javascript/">javascript</a>, <a class="tag-link" href="/tags/node-js/">node.js</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="1-後端-server-第一次的接觸"><a href="#1-後端-server-第一次的接觸" class="headerlink" title="1. 後端 server 第一次的接觸"></a>1. 後端 server 第一次的接觸</h2><p>前端應用也需要了解後端 server 的運作，在交握工作能更快速的彼此了解，進而加速工作效益。<br>從 github 上找了一個例子利用 node.js 的框架 express 來分析如何運作。</p>
<h3 id="1-1-簡單的-Express-伺服器"><a href="#1-1-簡單的-Express-伺服器" class="headerlink" title="1.1 簡單的 Express 伺服器"></a>1.1 簡單的 Express 伺服器</h3><p>Express 伺服器說明的<a href="https://kopu.chat/2017/08/11/node-js-express-%E5%88%9D%E5%85%A5%E9%96%80-%E4%B8%8A%E9%9B%86/" target="_blank" rel="noopener">參考資料</a></p>
<p>Express 的 server 與 router 概念目前沒有很熟悉，知道 router 是後端 server 與 client 端（Browser）中間的過程，幫助 server 解析 url、判斷 url 路徑、執行相應的動作。</p>
<p>簡單的 Express.js 伺服器設定，首先用 const express、宣告 express 這個變數載入 express 函式庫，再宣告 app 變數為 express function、建立一個 Express 伺服器；最後告訴伺服器聽取 3000 這個 Port。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">"express"</span>);</span><br><span class="line"><span class="keyword">const</span> app = express(); <span class="comment">// 建立一個express伺服器</span></span><br><span class="line">app.listen(<span class="number">3000</span>); <span class="comment">// 告訴server聽取3000的這個port</span></span><br></pre></td></tr></table></figure>
<p>在 terminal 中用 node 執行這個 js 檔案後，在 browser 網址輸入<code>localhost:3000</code>就可以連線到伺服器。<br>之後伺服器就要建立接受 request 跟回傳 response 方法，下面為<code>get</code>的 request，接受成功後會回傳字串回去。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// url:"/" 為根目錄</span></span><br><span class="line">app.get(<span class="string">"/"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  res.send(<span class="string">"Express is excellent!"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>伺服器也可以回傳常見的 JSON 格式，下面 url 改為<code>/blog</code>，當路徑在<code>/blog</code>下的時候會回傳 JSON 的內容。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">"/blog"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  res.json(&#123;</span><br><span class="line">    text: <span class="string">"Send blog page!"</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="1-2-request-與-response-參數獲取"><a href="#1-2-request-與-response-參數獲取" class="headerlink" title="1.2 request 與 response 參數獲取"></a>1.2 request 與 response 參數獲取</h3><p>透過 req.params 取得參數<br>當伺服器拿到<code>/post/:id</code>這個路徑時，回傳 id 這個參數，寫作<code>req.params.id</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">"/post/:id"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  res.send(req.params.id);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/GWwc662.png" alt></p>
<p>透過 req.query 獲取 key-value 的值 - 用在 get<br>在 url 路徑後輸入<code>?key=value</code>的方式，就可以透過<code>req.query</code>的方式獲得 JSON 格式的該資料。<br><code>res.send()</code>回傳資料到 browser 中。</p>
<p>ex. <code>URL:localhost:3000/hell?children=100</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">"/hell"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  res.send(req.query);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/1jKNRvq.png" alt></p>
<p>透過 req.body 獲取 request 的主要內容 - 用在 post<br>browser 發出 post 的 request 帶有資料到伺服器，資料主體就是 req.body。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.post(<span class="string">"/"</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(req.body);</span><br><span class="line">  res.send(req.body);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="2-Github-參考資料"><a href="#2-Github-參考資料" class="headerlink" title="2. Github 參考資料"></a>2. Github 參考資料</h2><p>Github：FaztWeb <a href="https://github.com/FaztWeb/nodejs-ajax-crud" target="_blank" rel="noopener">nodejs-ajax-crud</a></p>
<p>這個案例功能為獲取 products 資料，新增資料，修改，刪除<br>檔案則分為三部分：Server 伺服器、Routes 路由、Public 靜態網頁。<br><img src="https://i.imgur.com/QTyWL5B.png" alt></p>
<p>Server 檔案中不太理解裡面的內容，不過可以得知 port 是 3000。<br>routes 資料夾中的 index.js 的根目錄就是<code>/api/products</code>。</p>
<p>放上程式碼<br>Server:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);</span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">"express"</span>);</span><br><span class="line"><span class="keyword">const</span> morgan = <span class="built_in">require</span>(<span class="string">"morgan"</span>);</span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line"></span><br><span class="line"><span class="comment">// settings</span></span><br><span class="line">app.set(<span class="string">"port"</span>, process.env.PORT || <span class="number">3000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// middlewares</span></span><br><span class="line">app.use(morgan(<span class="string">"dev"</span>));</span><br><span class="line">app.use(express.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br><span class="line">app.use(express.json());</span><br><span class="line"></span><br><span class="line"><span class="comment">// routes</span></span><br><span class="line">app.use(<span class="string">"/api/products"</span>, <span class="built_in">require</span>(<span class="string">"./routes/index"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// static files</span></span><br><span class="line">app.use(express.static(path.join(__dirname, <span class="string">"public"</span>)));</span><br><span class="line"></span><br><span class="line"><span class="comment">// start the server</span></span><br><span class="line">app.listen(app.get(<span class="string">"port"</span>), () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`server on port <span class="subst">$&#123;app.get(<span class="string">"port"</span>)&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>Routes 中則是先把 products 指導一個 json 檔案，代表預設的資料內容與格式。<br>用到了四種方法：<code>get</code>、<code>post</code>、<code>put</code>、<code>delete</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">"express"</span>);</span><br><span class="line"><span class="keyword">const</span> router = express.Router();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> products = <span class="built_in">require</span>(<span class="string">"../data.json"</span>);</span><br><span class="line"><span class="comment">// data.json內容：</span></span><br><span class="line"><span class="comment">// [</span></span><br><span class="line"><span class="comment">//   &#123;</span></span><br><span class="line"><span class="comment">//     "id": 1,</span></span><br><span class="line"><span class="comment">//     "name": "laptop"</span></span><br><span class="line"><span class="comment">//   &#125;,</span></span><br><span class="line"><span class="comment">//   &#123;</span></span><br><span class="line"><span class="comment">//     "id": 2,</span></span><br><span class="line"><span class="comment">//     "name": "microphone"</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// ]</span></span><br><span class="line"></span><br><span class="line">router.get(<span class="string">"/"</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.json(products);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.post(<span class="string">"/"</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(req.body);</span><br><span class="line">  <span class="keyword">const</span> &#123; name &#125; = req.body;</span><br><span class="line">  products.push(&#123;</span><br><span class="line">    id: products.length + <span class="number">1</span>,</span><br><span class="line">    name</span><br><span class="line">  &#125;);</span><br><span class="line">  res.json(<span class="string">"Successfully created"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.put(<span class="string">"/:id"</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(req.body, req.params);</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.params;</span><br><span class="line">  <span class="keyword">const</span> &#123; name &#125; = req.body;</span><br><span class="line"></span><br><span class="line">  products.forEach(<span class="function">(<span class="params">product, i</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (product.id == id) &#123;</span><br><span class="line">      product.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  res.json(<span class="string">"Successfully updated"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.delete(<span class="string">"/:id"</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.params;</span><br><span class="line"></span><br><span class="line">  products.forEach(<span class="function">(<span class="params">product, i</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (product.id == id) &#123;</span><br><span class="line">      products.splice(i, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  res.json(<span class="string">"Successfully deleted"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router;</span><br></pre></td></tr></table></figure>
<p>靜態網頁的 html、jQuery 則是用來操作送出資料與 ajax 的方式<br><a href="https://github.com/FaztWeb/nodejs-ajax-crud/tree/master/src/public" target="_blank" rel="noopener">作者程式碼連結</a></p>
<h3 id="2-1-觀察分析-API"><a href="#2-1-觀察分析-API" class="headerlink" title="2.1 觀察分析 API"></a>2.1 觀察分析 API</h3><p>分析 http verb 的行為操作，這個案例用到了<code>get</code>、<code>post</code>、<code>put</code>、<code>delete</code>。</p>
<p>觀察程式碼後，分析出下面四個方法所做的事情</p>
<ul>
<li>get：獲取目前 json 資料，id=1 與 id=2 加上個別的 name 值</li>
<li>post：從 postman 用 body 送出一個 json-name 值，再 get 一次確認有無新增成功</li>
<li>put：url 需指到/:id 後，body 送出一個修改過的 name 值，再 get 一次確認有無修改成功</li>
<li>delet：url 需指到/:id 後，直接執行後再 get 一次確認有沒有成功刪除</li>
</ul>
<h4 id="2-1-1-Chrome-Network"><a href="#2-1-1-Chrome-Network" class="headerlink" title="2.1.1 Chrome Network"></a>2.1.1 Chrome Network</h4><p>在 terminal 用 node 開啟 server，在 chrome 中針對不同的 verb 輸入相應的 url，在 dev tool 中的 Network 可以觀察狀態與內容。<br><img src="https://i.imgur.com/TiAvdbK.png" alt></p>
<h4 id="2-1-2-Postman"><a href="#2-1-2-Postman" class="headerlink" title="2.1.2 Postman"></a>2.1.2 Postman</h4><p>用 Postman 模擬每一個 request 的行為，來分析這一個 API 在發出 request 後，後端獲取到什麼資訊。</p>
<p><strong>Get</strong><br>method與url輸入後按下send就可以確認結果。<br><img src="https://i.imgur.com/TaqatCC.png" alt></p>
<p><strong>POST</strong><br>選擇post method，送出的資料需要是在body裡面，在server中也console出body來確認資料內容。<br><img src="https://i.imgur.com/AiAwaKH.png" alt></p>
<p>從 route.js 還有 jQuery 的 code 來看，req.body = data<br>在 route.js 有看到會把新增的 id 還有 req.body 不含大括號的部分 push 回 data.json 的檔案中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// route.js</span></span><br><span class="line">router.post(<span class="string">"/"</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(req.body);</span><br><span class="line">  <span class="keyword">const</span> &#123; name &#125; = req.body;</span><br><span class="line">  products.push(&#123;</span><br><span class="line">    id: products.length + <span class="number">1</span>,</span><br><span class="line">    name</span><br><span class="line">  &#125;);</span><br><span class="line">  res.json(<span class="string">"Successfully created"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// jQuery</span></span><br><span class="line"><span class="comment">// POST PRODUCTS</span></span><br><span class="line">$(<span class="string">"#productForm"</span>).on(<span class="string">"submit"</span>, e =&gt; &#123;</span><br><span class="line">  e.preventDefault();</span><br><span class="line">  <span class="keyword">let</span> newProduct = $(<span class="string">"#newProduct"</span>);</span><br><span class="line"></span><br><span class="line">  $.ajax(&#123;</span><br><span class="line">    url: URI,</span><br><span class="line">    method: <span class="string">"POST"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      name: newProduct.val()</span><br><span class="line">    &#125;,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">      newProduct.val(<span class="string">""</span>);</span><br><span class="line">      $(<span class="string">"#getProducts"</span>).click();</span><br><span class="line">    &#125;,</span><br><span class="line">    error: <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>PUT</strong><br>put就是修改原有資料的意思，這裡是依照 id，url 要改為<code>/:id</code><br>在 route 中用 forEach + if 判斷來重新確認點擊 update 按鈕的該 id 要相同後，再去修改 name 值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// route</span></span><br><span class="line">router.put(<span class="string">"/:id"</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(req.body, req.params);</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.params;</span><br><span class="line">  <span class="keyword">const</span> &#123; name &#125; = req.body;</span><br><span class="line"></span><br><span class="line">  products.forEach(<span class="function">(<span class="params">product, i</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (product.id == id) &#123;</span><br><span class="line">      product.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  res.json(<span class="string">"Successfully updated"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>jQuery 中則是要先更新修改後的 value 到 data 裡面，成功後的 call back 會在執行 get 的事件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// jQuery</span></span><br><span class="line">$(<span class="string">"table"</span>).on(<span class="string">"click"</span>, <span class="string">".update-button"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> row = $(<span class="keyword">this</span>).closest(<span class="string">"tr"</span>);</span><br><span class="line">  <span class="keyword">let</span> id = row.find(<span class="string">".id"</span>).text();</span><br><span class="line">  <span class="keyword">let</span> name = row.find(<span class="string">".name"</span>).val();</span><br><span class="line"></span><br><span class="line">  $.ajax(&#123;</span><br><span class="line">    url: <span class="string">`<span class="subst">$&#123;URI&#125;</span>/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">    method: <span class="string">"PUT"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      name: name</span><br><span class="line">    &#125;,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(response);</span><br><span class="line">      $(<span class="string">"#getProducts"</span>).click();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>原本 id = 3 時，name=1，把 name改為3333333，再透過put的方式去修改後端資料。<br><img src="https://i.imgur.com/1joHKh8.png" alt></p>
<p>再用 get 確認<br><img src="https://i.imgur.com/ZmsXypg.png" alt></p>
<p><strong>Delete</strong><br>Delete method也就是刪除，這裡是依照 id，url 要改為/:id<br>在 route 中也是用 forEach + if 判斷來重新確認點擊 deleye 按鈕的該 id 要相符後用 splice 來刪除 server 上的資料。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// route</span></span><br><span class="line">router.delete(<span class="string">"/:id"</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.params;</span><br><span class="line"></span><br><span class="line">  products.forEach(<span class="function">(<span class="params">product, i</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (product.id == id) &#123;</span><br><span class="line">      products.splice(i, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  res.json(<span class="string">"Successfully deleted"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// jQuery</span></span><br><span class="line">$(<span class="string">"table"</span>).on(<span class="string">"click"</span>, <span class="string">".delete-button"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> row = $(<span class="keyword">this</span>).closest(<span class="string">"tr"</span>);</span><br><span class="line">  <span class="keyword">let</span> id = row.find(<span class="string">".id"</span>).text();</span><br><span class="line"></span><br><span class="line">  $.ajax(&#123;</span><br><span class="line">    url: <span class="string">`<span class="subst">$&#123;URI&#125;</span>/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">    method: <span class="string">"DELETE"</span>,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">      $(<span class="string">"#getProducts"</span>).click();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>執行 delete<br><img src="https://i.imgur.com/Jld8kZn.png" alt></p>
<p>get 確認<br><img src="https://i.imgur.com/pUfXmow.png" alt></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/categories/project">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-後端-server-第一次的接觸"><span class="toc-number">1.</span> <span class="toc-text">1. 後端 server 第一次的接觸</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-簡單的-Express-伺服器"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 簡單的 Express 伺服器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-request-與-response-參數獲取"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 request 與 response 參數獲取</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Github-參考資料"><span class="toc-number">2.</span> <span class="toc-text">2. Github 參考資料</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-觀察分析-API"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 觀察分析 API</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-Chrome-Network"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1 Chrome Network</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-Postman"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2 Postman</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/&text=[Node.js] - Express-Postman模擬"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/&title=[Node.js] - Express-Postman模擬"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/&is_video=false&description=[Node.js] - Express-Postman模擬"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=[Node.js] - Express-Postman模擬&body=Check out this article: https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/&title=[Node.js] - Express-Postman模擬"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/&title=[Node.js] - Express-Postman模擬"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/&title=[Node.js] - Express-Postman模擬"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/&title=[Node.js] - Express-Postman模擬"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://orow.github.io/2019/04/08/nodejs-ajax_faztweb/&name=[Node.js] - Express-Postman模擬&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 Orow Chou
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/categories/project">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<!-- clipboard -->

  <script src="/lib/clipboard/clipboard.min.js"></script>
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code pre").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>

<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
